# inclusive

* Step 1: Configure local_settings.py:

  Set DATA_DIR to the directory containing all csvs and a sub dir named "stage_1_test_images".
  Set TRAIN_IMG_DIR to the open images train image file diretory.

* Step 2: Install required python packages:  
  pytorch 0.4.1, torchvision, attrdict, PIL

* Step 3: Run preprocess

  ```python3 preprocess.py```

* Step 4: Train models

  ```
  python3 train_single_class.py --epochs 10
  python3 train_single_class.py --lrs cosine --lr 0.001 --min_lr 0.0001 --epochs 500
  python3 train.py --lrs cosine --lrs cosine --lr 0.001 --min_lr 0.0001 --epochs 100 --end_index 1000 --init_ckp <model file generated by above step> --init_num_classes 7172
  ```

  ```
  python3 train_single_class.py --epochs 10 --backbone resnet101
  python3 train_single_class.py --lrs cosine --lr 0.001 --min_lr 0.0001 --epochs 500 --backbone resnet101
  python3 train.py --lrs cosine --lrs cosine --lr 0.001 --min_lr 0.0001 --epochs 100 --end_index 1000 --init_ckp <model file generated by above step> --init_num_classes 7172 --backbone resnet101
  ```


* Step 5: Make prediction and submission

  ```
  python3 predict.py --end_index 1000 --sub_file sub1.csv --tuning_val
  python3 predict.py --end_index 1000 --sub_file sub2.csv --tuning_val --backbone resnet101
  python3 predict.py --ensemble_np <np files generated by above 2 predictions, splitted by ','> --th 0.04 --sub_file ensemble.csv
  ```
  ensemble.csv is the submission file.
